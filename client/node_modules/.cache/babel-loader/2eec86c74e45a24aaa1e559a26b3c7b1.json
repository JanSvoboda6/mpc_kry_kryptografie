{"ast":null,"code":"import _pt from \"prop-types\";\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useContext, useMemo, useEffect, useCallback } from 'react';\nimport { scaleBand } from '@visx/scale';\nimport DataContext from '../../../context/DataContext';\nimport getScaleBandwidth from '../../../utils/getScaleBandwidth';\nimport getScaleBaseline from '../../../utils/getScaleBaseline';\nimport isValidNumber from '../../../typeguards/isValidNumber';\nimport { BARGROUP_EVENT_SOURCE, XYCHART_EVENT_SOURCE } from '../../../constants';\nimport useSeriesEvents from '../../../hooks/useSeriesEvents';\nimport findNearestGroupDatum from '../../../utils/findNearestGroupDatum';\nimport getChildrenAndGrandchildrenWithProps from '../../../utils/getChildrenAndGrandchildrenWithProps';\nexport default function BaseBarGroup(_ref) {\n  var children = _ref.children,\n      _ref$padding = _ref.padding,\n      padding = _ref$padding === void 0 ? 0.1 : _ref$padding,\n      sortBars = _ref.sortBars,\n      BarsComponent = _ref.BarsComponent,\n      onBlur = _ref.onBlur,\n      onFocus = _ref.onFocus,\n      onPointerMove = _ref.onPointerMove,\n      onPointerOut = _ref.onPointerOut,\n      onPointerUp = _ref.onPointerUp,\n      _ref$enableEvents = _ref.enableEvents,\n      enableEvents = _ref$enableEvents === void 0 ? true : _ref$enableEvents;\n\n  var _ref2 = useContext(DataContext),\n      colorScale = _ref2.colorScale,\n      dataRegistry = _ref2.dataRegistry,\n      horizontal = _ref2.horizontal,\n      registerData = _ref2.registerData,\n      unregisterData = _ref2.unregisterData,\n      xScale = _ref2.xScale,\n      yScale = _ref2.yScale;\n\n  var barSeriesChildren = useMemo(function () {\n    return getChildrenAndGrandchildrenWithProps(children);\n  }, [children]); // extract data keys from child series\n\n  var dataKeys = useMemo(function () {\n    return barSeriesChildren.map(function (child) {\n      var _child$props$dataKey;\n\n      return (_child$props$dataKey = child.props.dataKey) != null ? _child$props$dataKey : '';\n    }).filter(function (key) {\n      return key;\n    });\n  }, [barSeriesChildren]); // register all child data\n\n  useEffect(function () {\n    var dataToRegister = barSeriesChildren.map(function (child) {\n      var _child$props = child.props,\n          key = _child$props.dataKey,\n          data = _child$props.data,\n          xAccessor = _child$props.xAccessor,\n          yAccessor = _child$props.yAccessor;\n      return {\n        key: key,\n        data: data,\n        xAccessor: xAccessor,\n        yAccessor: yAccessor\n      };\n    });\n    registerData(dataToRegister);\n    return function () {\n      return unregisterData(dataKeys);\n    };\n  }, [registerData, unregisterData, barSeriesChildren, dataKeys]); // create group scale\n\n  var groupScale = useMemo(function () {\n    return scaleBand({\n      domain: sortBars ? [].concat(dataKeys).sort(sortBars) : dataKeys,\n      range: [0, getScaleBandwidth(horizontal ? yScale : xScale)],\n      padding: padding\n    });\n  }, [sortBars, dataKeys, xScale, yScale, horizontal, padding]);\n  var findNearestDatum = useCallback(function (params) {\n    return findNearestGroupDatum(params, groupScale, horizontal);\n  }, [groupScale, horizontal]);\n  var ownEventSourceKey = BARGROUP_EVENT_SOURCE + \"-\" + dataKeys.join('-') + \"}\";\n  var eventEmitters = useSeriesEvents({\n    dataKey: dataKeys,\n    enableEvents: enableEvents,\n    findNearestDatum: findNearestDatum,\n    onBlur: onBlur,\n    onFocus: onFocus,\n    onPointerMove: onPointerMove,\n    onPointerOut: onPointerOut,\n    onPointerUp: onPointerUp,\n    source: ownEventSourceKey,\n    allowedSources: [XYCHART_EVENT_SOURCE, ownEventSourceKey]\n  });\n  var xZeroPosition = useMemo(function () {\n    return xScale ? getScaleBaseline(xScale) : 0;\n  }, [xScale]);\n  var yZeroPosition = useMemo(function () {\n    return yScale ? getScaleBaseline(yScale) : 0;\n  }, [yScale]);\n  var registryEntries = dataKeys.map(function (key) {\n    return dataRegistry.get(key);\n  }); // if scales and data are not available in the registry, bail\n\n  if (registryEntries.some(function (entry) {\n    return entry == null;\n  }) || !xScale || !yScale || !colorScale) {\n    return null;\n  }\n\n  var barThickness = getScaleBandwidth(groupScale);\n  var barSeries = registryEntries.map(function (_ref3) {\n    var _groupScale;\n\n    var xAccessor = _ref3.xAccessor,\n        yAccessor = _ref3.yAccessor,\n        data = _ref3.data,\n        key = _ref3.key;\n\n    var getLength = function getLength(d) {\n      var _xScale, _yScale;\n\n      return horizontal ? ((_xScale = xScale(xAccessor(d))) != null ? _xScale : NaN) - xZeroPosition : ((_yScale = yScale(yAccessor(d))) != null ? _yScale : NaN) - yZeroPosition;\n    };\n\n    var getGroupPosition = horizontal ? function (d) {\n      var _yScale2;\n\n      return (_yScale2 = yScale(yAccessor(d))) != null ? _yScale2 : NaN;\n    } : function (d) {\n      var _xScale2;\n\n      return (_xScale2 = xScale(xAccessor(d))) != null ? _xScale2 : NaN;\n    };\n    var withinGroupPosition = (_groupScale = groupScale(key)) != null ? _groupScale : 0;\n    var getX = horizontal ? function (d) {\n      return xZeroPosition + Math.min(0, getLength(d));\n    } : function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    };\n    var getY = horizontal ? function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    } : function (d) {\n      return yZeroPosition + Math.min(0, getLength(d));\n    };\n    var getWidth = horizontal ? function (d) {\n      return Math.abs(getLength(d));\n    } : function () {\n      return barThickness;\n    };\n    var getHeight = horizontal ? function () {\n      return barThickness;\n    } : function (d) {\n      return Math.abs(getLength(d));\n    }; // get props from child BarSeries, if available\n\n    var childBarSeries = barSeriesChildren.find(function (child) {\n      return child.props.dataKey === key;\n    });\n\n    var _ref4 = (childBarSeries == null ? void 0 : childBarSeries.props) || {},\n        colorAccessor = _ref4.colorAccessor,\n        radius = _ref4.radius,\n        radiusAll = _ref4.radiusAll,\n        radiusBottom = _ref4.radiusBottom,\n        radiusLeft = _ref4.radiusLeft,\n        radiusRight = _ref4.radiusRight,\n        radiusTop = _ref4.radiusTop;\n\n    return {\n      key: key,\n      radius: radius,\n      radiusAll: radiusAll,\n      radiusBottom: radiusBottom,\n      radiusLeft: radiusLeft,\n      radiusRight: radiusRight,\n      radiusTop: radiusTop,\n      bars: data.map(function (bar, index) {\n        var _colorAccessor;\n\n        var barX = getX(bar);\n        if (!isValidNumber(barX)) return null;\n        var barY = getY(bar);\n        if (!isValidNumber(barY)) return null;\n        var barWidth = getWidth(bar);\n        if (!isValidNumber(barWidth)) return null;\n        var barHeight = getHeight(bar);\n        if (!isValidNumber(barHeight)) return null;\n        return {\n          key: key + \"-\" + index,\n          x: barX,\n          y: barY,\n          width: barWidth,\n          height: barHeight,\n          fill: (_colorAccessor = colorAccessor == null ? void 0 : colorAccessor(bar, index)) != null ? _colorAccessor : colorScale(key)\n        };\n      }).filter(function (bar) {\n        return bar;\n      })\n    };\n  });\n  return /*#__PURE__*/React.createElement(\"g\", {\n    className: \"visx-bar-group\"\n  }, barSeries.map(function (series) {\n    return series && /*#__PURE__*/React.createElement(BarsComponent, _extends({\n      horizontal: horizontal,\n      xScale: xScale,\n      yScale: yScale\n    }, series, eventEmitters));\n  }));\n}\nBaseBarGroup.propTypes = {\n  children: _pt.oneOfType([_pt.element, _pt.arrayOf(_pt.element)]).isRequired,\n  padding: _pt.number,\n  sortBars: _pt.func\n};","map":{"version":3,"sources":["/Users/jan/dev/thesis/ml_runner/react/ml-runner/node_modules/@visx/xychart/esm/components/series/private/BaseBarGroup.js"],"names":["_pt","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","useContext","useMemo","useEffect","useCallback","scaleBand","DataContext","getScaleBandwidth","getScaleBaseline","isValidNumber","BARGROUP_EVENT_SOURCE","XYCHART_EVENT_SOURCE","useSeriesEvents","findNearestGroupDatum","getChildrenAndGrandchildrenWithProps","BaseBarGroup","_ref","children","_ref$padding","padding","sortBars","BarsComponent","onBlur","onFocus","onPointerMove","onPointerOut","onPointerUp","_ref$enableEvents","enableEvents","_ref2","colorScale","dataRegistry","horizontal","registerData","unregisterData","xScale","yScale","barSeriesChildren","dataKeys","map","child","_child$props$dataKey","props","dataKey","filter","dataToRegister","_child$props","data","xAccessor","yAccessor","groupScale","domain","concat","sort","range","findNearestDatum","params","ownEventSourceKey","join","eventEmitters","allowedSources","xZeroPosition","yZeroPosition","registryEntries","get","some","entry","barThickness","barSeries","_ref3","_groupScale","getLength","d","_xScale","_yScale","NaN","getGroupPosition","_yScale2","_xScale2","withinGroupPosition","getX","Math","min","getY","getWidth","abs","getHeight","childBarSeries","find","_ref4","colorAccessor","radius","radiusAll","radiusBottom","radiusLeft","radiusRight","radiusTop","bars","bar","index","_colorAccessor","barX","barY","barWidth","barHeight","x","y","width","height","fill","createElement","className","series","propTypes","oneOfType","element","arrayOf","isRequired","number","func"],"mappings":"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","sourcesContent":["import _pt from \"prop-types\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useContext, useMemo, useEffect, useCallback } from 'react';\nimport { scaleBand } from '@visx/scale';\nimport DataContext from '../../../context/DataContext';\nimport getScaleBandwidth from '../../../utils/getScaleBandwidth';\nimport getScaleBaseline from '../../../utils/getScaleBaseline';\nimport isValidNumber from '../../../typeguards/isValidNumber';\nimport { BARGROUP_EVENT_SOURCE, XYCHART_EVENT_SOURCE } from '../../../constants';\nimport useSeriesEvents from '../../../hooks/useSeriesEvents';\nimport findNearestGroupDatum from '../../../utils/findNearestGroupDatum';\nimport getChildrenAndGrandchildrenWithProps from '../../../utils/getChildrenAndGrandchildrenWithProps';\nexport default function BaseBarGroup(_ref) {\n  var children = _ref.children,\n      _ref$padding = _ref.padding,\n      padding = _ref$padding === void 0 ? 0.1 : _ref$padding,\n      sortBars = _ref.sortBars,\n      BarsComponent = _ref.BarsComponent,\n      onBlur = _ref.onBlur,\n      onFocus = _ref.onFocus,\n      onPointerMove = _ref.onPointerMove,\n      onPointerOut = _ref.onPointerOut,\n      onPointerUp = _ref.onPointerUp,\n      _ref$enableEvents = _ref.enableEvents,\n      enableEvents = _ref$enableEvents === void 0 ? true : _ref$enableEvents;\n\n  var _ref2 = useContext(DataContext),\n      colorScale = _ref2.colorScale,\n      dataRegistry = _ref2.dataRegistry,\n      horizontal = _ref2.horizontal,\n      registerData = _ref2.registerData,\n      unregisterData = _ref2.unregisterData,\n      xScale = _ref2.xScale,\n      yScale = _ref2.yScale;\n\n  var barSeriesChildren = useMemo(function () {\n    return getChildrenAndGrandchildrenWithProps(children);\n  }, [children]); // extract data keys from child series\n\n  var dataKeys = useMemo(function () {\n    return barSeriesChildren.map(function (child) {\n      var _child$props$dataKey;\n\n      return (_child$props$dataKey = child.props.dataKey) != null ? _child$props$dataKey : '';\n    }).filter(function (key) {\n      return key;\n    });\n  }, [barSeriesChildren]); // register all child data\n\n  useEffect(function () {\n    var dataToRegister = barSeriesChildren.map(function (child) {\n      var _child$props = child.props,\n          key = _child$props.dataKey,\n          data = _child$props.data,\n          xAccessor = _child$props.xAccessor,\n          yAccessor = _child$props.yAccessor;\n      return {\n        key: key,\n        data: data,\n        xAccessor: xAccessor,\n        yAccessor: yAccessor\n      };\n    });\n    registerData(dataToRegister);\n    return function () {\n      return unregisterData(dataKeys);\n    };\n  }, [registerData, unregisterData, barSeriesChildren, dataKeys]); // create group scale\n\n  var groupScale = useMemo(function () {\n    return scaleBand({\n      domain: sortBars ? [].concat(dataKeys).sort(sortBars) : dataKeys,\n      range: [0, getScaleBandwidth(horizontal ? yScale : xScale)],\n      padding: padding\n    });\n  }, [sortBars, dataKeys, xScale, yScale, horizontal, padding]);\n  var findNearestDatum = useCallback(function (params) {\n    return findNearestGroupDatum(params, groupScale, horizontal);\n  }, [groupScale, horizontal]);\n  var ownEventSourceKey = BARGROUP_EVENT_SOURCE + \"-\" + dataKeys.join('-') + \"}\";\n  var eventEmitters = useSeriesEvents({\n    dataKey: dataKeys,\n    enableEvents: enableEvents,\n    findNearestDatum: findNearestDatum,\n    onBlur: onBlur,\n    onFocus: onFocus,\n    onPointerMove: onPointerMove,\n    onPointerOut: onPointerOut,\n    onPointerUp: onPointerUp,\n    source: ownEventSourceKey,\n    allowedSources: [XYCHART_EVENT_SOURCE, ownEventSourceKey]\n  });\n  var xZeroPosition = useMemo(function () {\n    return xScale ? getScaleBaseline(xScale) : 0;\n  }, [xScale]);\n  var yZeroPosition = useMemo(function () {\n    return yScale ? getScaleBaseline(yScale) : 0;\n  }, [yScale]);\n  var registryEntries = dataKeys.map(function (key) {\n    return dataRegistry.get(key);\n  }); // if scales and data are not available in the registry, bail\n\n  if (registryEntries.some(function (entry) {\n    return entry == null;\n  }) || !xScale || !yScale || !colorScale) {\n    return null;\n  }\n\n  var barThickness = getScaleBandwidth(groupScale);\n  var barSeries = registryEntries.map(function (_ref3) {\n    var _groupScale;\n\n    var xAccessor = _ref3.xAccessor,\n        yAccessor = _ref3.yAccessor,\n        data = _ref3.data,\n        key = _ref3.key;\n\n    var getLength = function getLength(d) {\n      var _xScale, _yScale;\n\n      return horizontal ? ((_xScale = xScale(xAccessor(d))) != null ? _xScale : NaN) - xZeroPosition : ((_yScale = yScale(yAccessor(d))) != null ? _yScale : NaN) - yZeroPosition;\n    };\n\n    var getGroupPosition = horizontal ? function (d) {\n      var _yScale2;\n\n      return (_yScale2 = yScale(yAccessor(d))) != null ? _yScale2 : NaN;\n    } : function (d) {\n      var _xScale2;\n\n      return (_xScale2 = xScale(xAccessor(d))) != null ? _xScale2 : NaN;\n    };\n    var withinGroupPosition = (_groupScale = groupScale(key)) != null ? _groupScale : 0;\n    var getX = horizontal ? function (d) {\n      return xZeroPosition + Math.min(0, getLength(d));\n    } : function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    };\n    var getY = horizontal ? function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    } : function (d) {\n      return yZeroPosition + Math.min(0, getLength(d));\n    };\n    var getWidth = horizontal ? function (d) {\n      return Math.abs(getLength(d));\n    } : function () {\n      return barThickness;\n    };\n    var getHeight = horizontal ? function () {\n      return barThickness;\n    } : function (d) {\n      return Math.abs(getLength(d));\n    }; // get props from child BarSeries, if available\n\n    var childBarSeries = barSeriesChildren.find(function (child) {\n      return child.props.dataKey === key;\n    });\n\n    var _ref4 = (childBarSeries == null ? void 0 : childBarSeries.props) || {},\n        colorAccessor = _ref4.colorAccessor,\n        radius = _ref4.radius,\n        radiusAll = _ref4.radiusAll,\n        radiusBottom = _ref4.radiusBottom,\n        radiusLeft = _ref4.radiusLeft,\n        radiusRight = _ref4.radiusRight,\n        radiusTop = _ref4.radiusTop;\n\n    return {\n      key: key,\n      radius: radius,\n      radiusAll: radiusAll,\n      radiusBottom: radiusBottom,\n      radiusLeft: radiusLeft,\n      radiusRight: radiusRight,\n      radiusTop: radiusTop,\n      bars: data.map(function (bar, index) {\n        var _colorAccessor;\n\n        var barX = getX(bar);\n        if (!isValidNumber(barX)) return null;\n        var barY = getY(bar);\n        if (!isValidNumber(barY)) return null;\n        var barWidth = getWidth(bar);\n        if (!isValidNumber(barWidth)) return null;\n        var barHeight = getHeight(bar);\n        if (!isValidNumber(barHeight)) return null;\n        return {\n          key: key + \"-\" + index,\n          x: barX,\n          y: barY,\n          width: barWidth,\n          height: barHeight,\n          fill: (_colorAccessor = colorAccessor == null ? void 0 : colorAccessor(bar, index)) != null ? _colorAccessor : colorScale(key)\n        };\n      }).filter(function (bar) {\n        return bar;\n      })\n    };\n  });\n  return /*#__PURE__*/React.createElement(\"g\", {\n    className: \"visx-bar-group\"\n  }, barSeries.map(function (series) {\n    return series && /*#__PURE__*/React.createElement(BarsComponent, _extends({\n      horizontal: horizontal,\n      xScale: xScale,\n      yScale: yScale\n    }, series, eventEmitters));\n  }));\n}\nBaseBarGroup.propTypes = {\n  children: _pt.oneOfType([_pt.element, _pt.arrayOf(_pt.element)]).isRequired,\n  padding: _pt.number,\n  sortBars: _pt.func\n};"]},"metadata":{},"sourceType":"module"}